# IVFuseNet: Fusion of Infrared and Visible Images for Depth Prediction

This repository includes the code for our model and out dataset for depth prediction task. 

This code works on Python 3 & TensorFlow 1.4 and the images in this dataset are of actual road scenes captured while unmanned vehicle driving.

If this code and dataset are provided for research purposes, please see License section below.

## Model

This model is similar to the models provied by paper [1] and [2]. Its structure looks just like the following illustration:

![Network](/pics/pic1.png)

### train

```python
python train.py
```

### test

```python
python test.py
```


## Files

Currently the dataset contains 6000 [infrared images](infrared_images), [visible light images](visible_light_images) and [raw depth maps](depth_maps).

```
------------------------------------------
infrared images         | 6000 | 7.40M
visible light images    | 6000 |  396K
raw depth maps          | 6000 | 1.11M
------------------------------------------
```

### Format
The raw images in Snow-road dataset are the resolution of 256Ã—512.

Next, the depth map that display on `Example` are generated by classifying the raw depth map into 32 levels in the logarithmic space.We use the generated depth maps as training and testing labels.

- To preprocess the raw depth map:
```python
python preprocess.py
```
### Example

#### infrared images:

![infrared_image](/example/infrared_image.png)

#### visible light images:

![visible light image](/example/visible_light_image.png)

#### depth maps

![depth_map](/example/depth_map.png)

### Usage
If you want to use the formatted images,you can load the test data(.h5 file) in [testData](testData)

Start with importing `package`:
```python
import h5py
import matplotlib.pyplot as plt
```
- To load a dataset:
```python
def read_hdf5(file_name):
    with h5py.File(file_name, 'r') as f:
        images = np.asarray(f['images'])
        depths = np.asarray(f['depths'])
        infrareds = np.asarray(f['infrareds'])
    return images,depths,infrareds
images,depths,infrareds=read_hdf5('test_snow_data.h5')
```
- To display the image of a dataset:
```python
i, j = 0,4
imageTest = images[i:j]
plt.imshow(imageTest[0],cmap='jet')
```


## License
I provide this dataset for research purposes, please follow `Citing`.

For removal of copyrighted content, please contact me on GitHub.


## Citing
If you use this dataset in academic work, please cite as follows:

```bibtex
@misc{Yuqi,
        title={A dataset of Snow-road},
        url={https://github.com/humdingers/Depth-imaget},
        author={Yuqi, Li},
        year={2019},
        publisher = {GitHub},
        journal = {GitHub repository}
}
```
